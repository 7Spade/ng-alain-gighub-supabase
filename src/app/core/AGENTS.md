# Core æ¨¡çµ„é–‹ç™¼è¦ç¯„ï¼ˆGitHub Copilot Agent å„ªåŒ–ç‰ˆï¼‰

## ğŸ“‘ ç›®éŒ„

- [ğŸ¯ Core æ¨¡çµ„è·è²¬](#-core-æ¨¡çµ„è·è²¬)
- [âš¡ å¿«é€Ÿåƒè€ƒ](#-å¿«é€Ÿåƒè€ƒ)
  - [ä¾è³´é—œä¿‚](#ä¾è³´é—œä¿‚)
  - [é—œéµåŸå‰‡](#é—œéµåŸå‰‡)
- [ğŸ“‹ æ ¸å¿ƒè¦ç¯„æª¢æŸ¥æ¸…å–®](#-æ ¸å¿ƒè¦ç¯„æª¢æŸ¥æ¸…å–®)
  - [HTTP æ””æˆªå™¨ï¼ˆInterceptorsï¼‰](#http-æ””æˆªå™¨interceptors)
  - [éŒ¯èª¤è™•ç†æœå‹™](#éŒ¯èª¤è™•ç†æœå‹™)
  - [æ‡‰ç”¨å•Ÿå‹•æœå‹™](#æ‡‰ç”¨å•Ÿå‹•æœå‹™)
  - [è·¯ç”±å®ˆè¡›](#è·¯ç”±å®ˆè¡›)
  - [Supabase æ“ä½œ](#supabase-æ“ä½œ)
- [ğŸ§ª æ¸¬è©¦è¦æ±‚](#-æ¸¬è©¦è¦æ±‚)
  - [è¦†è“‹ç‡æ¨™æº–](#è¦†è“‹ç‡æ¨™æº–)
  - [æ¸¬è©¦é‡é»](#æ¸¬è©¦é‡é»)
- [ğŸ“š ç›¸é—œ Cursor è¦å‰‡](#-ç›¸é—œ-cursor-è¦å‰‡)
  - [æ¨¡çµ„ç‰¹å®šè¦å‰‡](#æ¨¡çµ„ç‰¹å®šè¦å‰‡)
  - [é€šç”¨è¦å‰‡ï¼ˆè‡ªå‹•æ‡‰ç”¨ï¼‰](#é€šç”¨è¦å‰‡è‡ªå‹•æ‡‰ç”¨)
- [ğŸ”— ç›¸é—œæ–‡æª”](#-ç›¸é—œæ–‡æª”)
  - [å¿…è®€æ–‡æª”](#å¿…è®€æ–‡æª”)
  - [åƒè€ƒæ–‡æª”](#åƒè€ƒæ–‡æª”)
- [ğŸ’¡ AI åŠ©æ‰‹ä½¿ç”¨å»ºè­°](#-ai-åŠ©æ‰‹ä½¿ç”¨å»ºè­°)
  - [é©åˆä½¿ç”¨çš„ AI åŠ©æ‰‹](#é©åˆä½¿ç”¨çš„-ai-åŠ©æ‰‹)
  - [å¸¸è¦‹ Prompt ç¯„ä¾‹](#å¸¸è¦‹-prompt-ç¯„ä¾‹)

---

> ğŸ“– **ç›®çš„**ï¼šç‚º Core æ¨¡çµ„é–‹ç™¼æä¾› AI åŠ©æ‰‹å‹å–„çš„è¦ç¯„æŒ‡å¼•ã€‚æœ¬æ¨¡çµ„è¦ç¯„å·²æ•´åˆåˆ° Cursor è¦å‰‡ç³»çµ±ï¼ˆ`.cursor/rules/core-specific.mdc`ï¼‰ï¼Œè¦å‰‡æœƒè‡ªå‹•æ‡‰ç”¨åˆ° `src/app/core/` ç›®éŒ„ã€‚

## ğŸ¯ Core æ¨¡çµ„è·è²¬

Core æ¨¡çµ„æ˜¯æ‡‰ç”¨ç¨‹å¼çš„**æ ¸å¿ƒåŸºç¤è¨­æ–½å±¤**ï¼Œæä¾›ï¼š
- ğŸŒ **ç¶²è·¯è«‹æ±‚æ””æˆª**ï¼šHTTP Interceptorsã€èªè­‰ tokenã€éŒ¯èª¤è™•ç†ã€é‡è©¦é‚è¼¯
- ğŸŒ **åœ‹éš›åŒ–æœå‹™**ï¼ši18nã€å¤šèªè¨€è³‡æºç®¡ç†ã€å‹•æ…‹èªè¨€åˆ‡æ›
- ğŸš€ **æ‡‰ç”¨å•Ÿå‹•é‚è¼¯**ï¼šåˆå§‹åŒ–é…ç½®ã€èªè­‰æ¢å¾©ã€è³‡æºé åŠ è¼‰
- ğŸ›¡ï¸ **è·¯ç”±å®ˆè¡›**ï¼šcanActivate/canActivateChildã€èªè­‰é©—è­‰ã€æ¬Šé™æª¢æŸ¥
- ğŸ—„ï¸ **Supabase æ•´åˆ**ï¼šè³‡æ–™åº«æ“ä½œã€RLS ç­–ç•¥ã€Repository æ¨¡å¼

## âš¡ å¿«é€Ÿåƒè€ƒ

### ä¾è³´é—œä¿‚
```typescript
âŒ ç¦æ­¢ä¾è³´ï¼šcore ä¸å¯ä¾è³´ routes æˆ– shared
```

### é—œéµåŸå‰‡
- **å–®ä¾‹æœå‹™**ï¼šä½¿ç”¨ `@Injectable({ providedIn: 'root' })`
- **éŒ¯èª¤è™•ç†**ï¼š`ErrorStateService` çµ±ä¸€ç®¡ç†ï¼Œæ˜ç¢ºåˆ†é¡
- **ç‹€æ…‹ç®¡ç†**ï¼šä½¿ç”¨ Signalsï¼Œæš´éœ² `ReadonlySignal`
- **å®‰å…¨ç¬¬ä¸€**ï¼šSupabase RLS ç­–ç•¥ã€Token ç®¡ç†ã€ç’°å¢ƒè®Šæ•¸

## ğŸ“‹ æ ¸å¿ƒè¦ç¯„æª¢æŸ¥æ¸…å–®

### HTTP æ””æˆªå™¨ï¼ˆInterceptorsï¼‰
- [ ] çµ±ä¸€æ·»åŠ èªè­‰ tokenï¼ˆfrom `@delon/auth TokenService`ï¼‰
- [ ] çµ±ä¸€éŒ¯èª¤è™•ç†ï¼ˆè½‰ç™¼åˆ° `ErrorStateService`ï¼‰
- [ ] å¯¦ç¾é‡è©¦é‚è¼¯ï¼ˆ3 æ¬¡ï¼ŒæŒ‡æ•¸é€€é¿ï¼‰
- [ ] è¨­å®šè«‹æ±‚è¶…æ™‚ï¼ˆ30 ç§’ï¼‰
- [ ] è¨˜éŒ„è«‹æ±‚æ—¥èªŒï¼ˆé–‹ç™¼ç’°å¢ƒï¼‰

```typescript
// âœ… æ­£ç¢ºç¯„ä¾‹
export const authInterceptor: HttpInterceptorFn = (req, next) => {
  const tokenService = inject(TokenService);
  const token = tokenService.get()?.token;

  if (token) {
    req = req.clone({
      setHeaders: { Authorization: `Bearer ${token}` }
    });
  }

  return next(req);
};
```

### éŒ¯èª¤è™•ç†æœå‹™
- [ ] ä½¿ç”¨ Signals ç®¡ç†éŒ¯èª¤ç‹€æ…‹
- [ ] åˆ†é¡éŒ¯èª¤ï¼šç¶²è·¯éŒ¯èª¤ã€èªè­‰éŒ¯èª¤ã€æ¥­å‹™éŒ¯èª¤
- [ ] æä¾›é‡è©¦æ©Ÿåˆ¶
- [ ] å‹å–„çš„ç”¨æˆ¶éŒ¯èª¤è¨Šæ¯
- [ ] è¨˜éŒ„éŒ¯èª¤æ—¥èªŒ

```typescript
// âœ… æ­£ç¢ºç¯„ä¾‹
@Injectable({ providedIn: 'root' })
export class ErrorStateService {
  private errorSignal = signal<AppError | null>(null);
  readonly error = this.errorSignal.asReadonly();

  setError(error: AppError): void {
    this.errorSignal.set(error);
  }

  clearError(): void {
    this.errorSignal.set(null);
  }
}
```

### æ‡‰ç”¨å•Ÿå‹•æœå‹™
- [ ] åˆå§‹åŒ–æ‡‰ç”¨é…ç½®
- [ ] æ¢å¾©ç”¨æˆ¶èªè­‰ç‹€æ…‹
- [ ] é åŠ è¼‰å¿…è¦è³‡æº
- [ ] éŒ¯èª¤è™•ç†èˆ‡é™ç´šç­–ç•¥
- [ ] å•Ÿå‹•é€²åº¦åé¥‹

### è·¯ç”±å®ˆè¡›
- [ ] æª¢æŸ¥èªè­‰ç‹€æ…‹ï¼ˆä½¿ç”¨ `@delon/auth`ï¼‰
- [ ] æª¢æŸ¥ç”¨æˆ¶æ¬Šé™ï¼ˆåŸºæ–¼ Supabase RLSï¼‰
- [ ] æœªèªè­‰æ™‚å°å‘ç™»å…¥é 
- [ ] ç„¡æ¬Šé™æ™‚é¡¯ç¤º 403 é é¢
- [ ] è¨˜éŒ„å°èˆªæ—¥èªŒ

### Supabase æ“ä½œ
- [ ] å•Ÿç”¨ RLS ç­–ç•¥
- [ ] ä½¿ç”¨ Repository æ¨¡å¼
- [ ] é¡å‹å®‰å…¨ï¼ˆä½¿ç”¨ `database.types.ts`ï¼‰
- [ ] éŒ¯èª¤è™•ç†èˆ‡é‡è©¦
- [ ] é€£æ¥æ± ç®¡ç†

## ğŸ§ª æ¸¬è©¦è¦æ±‚

### è¦†è“‹ç‡æ¨™æº–
- **æœå‹™å±¤**ï¼šâ‰¥80% è¦†è“‹ç‡ï¼ˆå¿…é ˆï¼‰
- **é—œéµé‚è¼¯**ï¼š100% è¦†è“‹ç‡ï¼ˆå¿…é ˆï¼‰
- **HTTP æ””æˆªå™¨**ï¼š100% è¦†è“‹ç‡ï¼ˆæ¨è–¦ï¼‰
- **è·¯ç”±å®ˆè¡›**ï¼š100% è¦†è“‹ç‡ï¼ˆæ¨è–¦ï¼‰

### æ¸¬è©¦é‡é»
- [ ] HTTP æ””æˆªå™¨ï¼štoken æ·»åŠ ã€éŒ¯èª¤è™•ç†ã€é‡è©¦é‚è¼¯
- [ ] éŒ¯èª¤è™•ç†æœå‹™ï¼šåˆ†é¡ã€é‡è©¦ã€æ¸…é™¤
- [ ] æ‡‰ç”¨å•Ÿå‹•æœå‹™ï¼šåˆå§‹åŒ–æµç¨‹ã€éŒ¯èª¤é™ç´š
- [ ] è·¯ç”±å®ˆè¡›ï¼šèªè­‰æª¢æŸ¥ã€æ¬Šé™é©—è­‰ã€å°èˆªé‚è¼¯

## ğŸ“š ç›¸é—œ Cursor è¦å‰‡

### æ¨¡çµ„ç‰¹å®šè¦å‰‡
- [Core æ¨¡çµ„ç‰¹å®šè¦ç¯„](../../.cursor/rules/core-specific.mdc) â­ è‡ªå‹•æ‡‰ç”¨

### é€šç”¨è¦å‰‡ï¼ˆè‡ªå‹•æ‡‰ç”¨ï¼‰
- [TypeScript é¡å‹å®‰å…¨](../../.cursor/rules/typescript.mdc)
- [éŒ¯èª¤è™•ç†](../../.cursor/rules/error-handling.mdc)
- [API è¨­è¨ˆ](../../.cursor/rules/api-design.mdc)
- [å®‰å…¨è¦ç¯„](../../.cursor/rules/security.mdc)
- [æ¸¬è©¦è¦ç¯„](../../.cursor/rules/testing.mdc)

## ğŸ”— ç›¸é—œæ–‡æª”

### å¿…è®€æ–‡æª”
- [å®Œæ•´é–‹ç™¼è¦ç¯„](../../AGENTS.md) - AI åŠ©æ‰‹ç¸½è¦½
- [éŒ¯èª¤è™•ç†æŒ‡å—](../../docs/guides/error-handling-guide.md)
- [æ¸¬è©¦æŒ‡å—](../../docs/guides/testing-guide.md)
- [RLS ç­–ç•¥é–‹ç™¼æŒ‡å—](../../docs/guides/rls-policy-development-guide.md)

### åƒè€ƒæ–‡æª”
- [æ¶æ§‹èªªæ˜](../../docs/architecture/README.md) - ç³»çµ±æ¶æ§‹è¨­è¨ˆ
- [é–‹ç™¼è„ˆçµ¡](../../docs/development/getting-started.md) - æŠ€è¡“é¸å‹ã€è¨­è¨ˆæ±ºç­–
- [ä¸Šä¸‹æ–‡è„ˆçµ¡](../../docs/README.md) - Domain ç”¨èªã€æ¥­å‹™èƒŒæ™¯

## ğŸ’¡ AI åŠ©æ‰‹ä½¿ç”¨å»ºè­°

### é©åˆä½¿ç”¨çš„ AI åŠ©æ‰‹
- **GitHub Copilot**ï¼šæ—¥å¸¸é–‹ç™¼ã€ä»£ç¢¼è£œå…¨
- **Cursor IDE**ï¼šå³æ™‚è¦å‰‡æª¢æŸ¥ã€ä»£ç¢¼å»ºè­°
- **Claude AI**ï¼šè¤‡é›œæœå‹™è¨­è¨ˆã€éŒ¯èª¤è™•ç†ç­–ç•¥
- **Gemini**ï¼šæœå°‹æœ€æ–°å®‰å…¨å¯¦è¸ã€API æ›´æ–°

### å¸¸è¦‹ Prompt ç¯„ä¾‹
è«‹ç‚º Core æ¨¡çµ„å‰µå»ºä¸€å€‹ HTTP æ””æˆªå™¨ï¼Œè¦æ±‚ï¼š
```text
2. çµ±ä¸€éŒ¯èª¤è™•ç†
3. å¯¦ç¾ 3 æ¬¡é‡è©¦ï¼ˆæŒ‡æ•¸é€€é¿ï¼‰
4. éµå¾ª .cursor/rules/core-specific.mdc è¦ç¯„
```

---

**æœ€å¾Œæ›´æ–°**ï¼š2025-01-20  
**æ¶æ§‹ç‰ˆæœ¬**ï¼šv2.0  
**ç¶­è­·è€…**ï¼šé–‹ç™¼åœ˜éšŠ  
**é©ç”¨**ï¼šGitHub Copilot Agent Mode

