<page-header [title]="'刪除任務'"></page-header>

@if (loading()) {
  <nz-spin nzSimple></nz-spin>
} @else if (task()) {
  <nz-card>
    <nz-alert nzType="warning" nzMessage="警告" nzDescription="此操作將永久刪除任務及其所有子任務，無法復原。" nzShowIcon class="mb-lg"></nz-alert>

    <nz-descriptions nzBordered [nzColumn]="1">
      <nz-descriptions-item nzTitle="任務名稱">{{ task()!.name }}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="描述">{{ task()!.description || '無' }}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="層級">{{ getTaskLevel(task()!) }}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="狀態">{{ getStatusText(task()!.status) }}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="優先級">{{ getPriorityText(task()!.priority) }}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="區域">{{ task()!.area || '無' }}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="標籤">{{ task()!.tags.join(', ') || '無' }}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="進度">{{ task()!.progress }}%</nz-descriptions-item>
      <nz-descriptions-item nzTitle="子任務數">{{ task()!.childCount }}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="建立時間">{{ task()!.createdAt | date:'medium' }}</nz-descriptions-item>
      @if (task()!.dueDate) {
        <nz-descriptions-item nzTitle="截止日期">{{ task()!.dueDate | date:'medium' }}</nz-descriptions-item>
      }
    </nz-descriptions>

    <div class="text-center mt-lg">
      <button nz-button nzType="default" (click)="onCancel()" [disabled]="loading()">
        取消
      </button>
      <button nz-button nzType="primary" nzDanger (click)="showDeleteConfirm()" [nzLoading]="loading()" class="ml-sm">
        刪除
      </button>
    </div>
  </nz-card>
}
